<!DOCTYPE html>
<html lang="en">
<head><link crossorigin href="//assets.gradle.com" rel="preconnect">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,400i">
<link rel="stylesheet" href="https://guides.gradle.org/css/asciidoctor.css">
<link rel="stylesheet" href="https://guides.gradle.org/css/docs-blue-theme-4.5.2.css">
<link rel="apple-touch-icon" sizes="180x180" href="https://guides.gradle.org/icon/apple-touch-icon.png">
<link rel="icon" type="image/png" href="https://guides.gradle.org/icon/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://guides.gradle.org/icon/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="https://guides.gradle.org/icon/manifest.json">
<link rel="mask-icon" href="https://guides.gradle.org/icon/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="https://guides.gradle.org/icon/favicon.ico">
<script defer src="https://guides.gradle.org/js/guides.js"></script>
<script defer src="https://guides.gradle.org/js/set-time-to-complete-text.js"></script>
<script async src="https://guides.gradle.org/js/autotrack.js"></script>

<meta charset="utf-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Peter Ledbrook, Stefan Oehme, Tim Yates, FranÃ§ois Guillot, Craig Atkinson">
<title>Improving the Performance of Gradle Builds</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article">
<header class="site-layout__header site-header" itemscope="itemscope" itemtype="https://schema.org/WPHeader">
    <nav class="site-header__navigation" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement">
        <div class="site-header__navigation-header">
            <a target="_top" class="logo" href="https://guides.gradle.org" title="Gradle Docs"><svg width="179px" height="36px" viewBox="0 0 214 43" version="1.1" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M46.8764467,7.88772959 C45.3200364,5.08928963 42.538267,4.25293158 40.5730047,4.21328173 C38.1617855,4.16464717 36.1814618,5.49994885 36.5560017,6.37654271 C36.6363956,6.56473304 37.0884369,7.5470924 37.3659256,7.95257566 C37.767596,8.5393154 38.4866528,8.08851802 38.7385072,7.95462652 C39.4905793,7.55490518 40.2943191,7.42550602 41.2059822,7.53175982 C42.0774483,7.63332596 43.2351806,8.17045455 44.0118896,9.6627931 C45.8397043,13.1750281 40.1972679,20.4036071 33.1344723,15.3978616 C26.0715771,10.3921161 19.203283,12.0507692 16.0936541,13.059692 C12.9841249,14.0684195 11.5547888,15.0829089 12.7835391,17.4289889 C14.4533587,20.6171889 13.8998775,19.6389313 15.519027,22.2780882 C18.0908346,26.4697421 23.7203042,20.3491129 23.7203042,20.3491129 C19.526654,26.5308771 15.931769,25.0372689 14.5529036,22.8762541 C13.3102888,20.9285282 12.3447638,18.6830377 12.3447638,18.6830377 C1.72319071,22.4290701 4.5969243,38.9663805 4.5969243,38.9663805 L9.87170315,38.9663805 C11.2165558,32.8772955 16.0248305,33.1018153 16.848918,38.9663805 L20.8738008,38.9663805 C24.4333764,27.0763067 33.4552501,38.9663805 33.4552501,38.9663805 L38.701901,38.9663805 C37.2324677,30.8555435 41.6532357,28.3073078 44.4391943,23.5530361 C47.2254521,18.7983738 49.8646868,12.9818572 46.8764467,7.88772959 L46.8764467,7.88772959 Z M33.3433369,23.5472742 C30.5694474,22.6419684 31.5616042,19.8816157 31.5616042,19.8816157 C31.5616042,19.8816157 33.9840944,20.6649445 37.2609946,21.7341234 C37.0723781,22.5903064 35.4423564,24.232455 33.3433369,23.5472742 L33.3433369,23.5472742 Z" id="Fill-9" fill="#02303A"></path><path d="M35.8042288,21.4659498 C35.8871163,22.2300396 35.3025149,22.9172712 34.4983762,23.0008679 C33.6942375,23.0844647 32.9752804,22.5327848 32.8923929,21.7685973 C32.8095053,21.0045075 33.3942065,20.3172758 34.1982455,20.2336791 C35.0023842,20.1500824 35.721441,20.7017623 35.8042288,21.4659498" id="Fill-10" fill="#00303A"></path><path d="M72.236,22.3 L72.236,29.32 C71.3559956,29.9680032 70.418005,30.4419985 69.422,30.742 C68.425995,31.0420015 67.3600057,31.192 66.224,31.192 C64.8079929,31.192 63.5260057,30.9720022 62.378,30.532 C61.2299943,30.0919978 60.2500041,29.4800039 59.438,28.696 C58.6259959,27.9119961 58.0000022,26.9760054 57.56,25.888 C57.1199978,24.7999946 56.9,23.6120064 56.9,22.324 C56.9,21.0199935 57.1119979,19.8240054 57.536,18.736 C57.9600021,17.6479946 58.5619961,16.7120039 59.342,15.928 C60.1220039,15.1439961 61.0679944,14.5360022 62.18,14.104 C63.2920056,13.6719978 64.5399931,13.456 65.924,13.456 C66.6280035,13.456 67.2859969,13.5119994 67.898,13.624 C68.5100031,13.7360006 69.0779974,13.889999 69.602,14.086 C70.1260026,14.282001 70.6039978,14.5199986 71.036,14.8 C71.4680022,15.0800014 71.8639982,15.3879983 72.224,15.724 L71.3,17.188 C71.1559993,17.4200012 70.9680012,17.5619997 70.736,17.614 C70.5039988,17.6660003 70.2520014,17.6080008 69.98,17.44 L69.188,16.984 C68.9239987,16.8319992 68.6300016,16.7000006 68.306,16.588 C67.9819984,16.4759994 67.618002,16.3840004 67.214,16.312 C66.809998,16.2399996 66.3440026,16.204 65.816,16.204 C64.9599957,16.204 64.1860035,16.3479986 63.494,16.636 C62.8019965,16.9240014 62.2120024,17.3359973 61.724,17.872 C61.2359976,18.4080027 60.8600013,19.0519962 60.596,19.804 C60.3319987,20.5560038 60.2,21.3959954 60.2,22.324 C60.2,23.316005 60.3419986,24.2019961 60.626,24.982 C60.9100014,25.7620039 61.3099974,26.4219973 61.826,26.962 C62.3420026,27.5020027 62.9639964,27.9139986 63.692,28.198 C64.4200036,28.4820014 65.2319955,28.624 66.128,28.624 C66.7680032,28.624 67.3399975,28.5560007 67.844,28.42 C68.3480025,28.2839993 68.8399976,28.1000012 69.32,27.868 L69.32,24.724 L67.136,24.724 C66.927999,24.724 66.7660006,24.6660006 66.65,24.55 C66.5339994,24.4339994 66.476,24.2920008 66.476,24.124 L66.476,22.3 L72.236,22.3 Z M77.504,20.824 C77.8880019,20.0879963 78.3439974,19.5100021 78.872,19.09 C79.4000026,18.6699979 80.0239964,18.46 80.744,18.46 C81.3120028,18.46 81.7679983,18.5839988 82.112,18.832 L81.92,21.052 C81.8799998,21.1960007 81.8220004,21.2979997 81.746,21.358 C81.6699996,21.4180003 81.5680006,21.448 81.44,21.448 C81.3199994,21.448 81.1420012,21.4280002 80.906,21.388 C80.6699988,21.3479998 80.4400011,21.328 80.216,21.328 C79.8879984,21.328 79.5960013,21.3759995 79.34,21.472 C79.0839987,21.5680005 78.854001,21.7059991 78.65,21.886 C78.445999,22.0660009 78.2660008,22.2839987 78.11,22.54 C77.9539992,22.7960013 77.8080007,23.0879984 77.672,23.416 L77.672,31 L74.708,31 L74.708,18.688 L76.448,18.688 C76.7520015,18.688 76.9639994,18.7419995 77.084,18.85 C77.2040006,18.9580005 77.2839998,19.1519986 77.324,19.432 L77.504,20.824 Z M90.008,25.744 C89.1519957,25.7840002 88.4320029,25.8579995 87.848,25.966 C87.2639971,26.0740005 86.7960018,26.2119992 86.444,26.38 C86.0919982,26.5480008 85.8400008,26.7439989 85.688,26.968 C85.5359992,27.1920011 85.46,27.4359987 85.46,27.7 C85.46,28.2200026 85.6139985,28.5919989 85.922,28.816 C86.2300015,29.0400011 86.6319975,29.152 87.128,29.152 C87.736003,29.152 88.2619978,29.0420011 88.706,28.822 C89.1500022,28.6019989 89.5839979,28.2680022 90.008,27.82 L90.008,25.744 Z M83.216,20.404 C84.6320071,19.1079935 86.33599,18.46 88.328,18.46 C89.0480036,18.46 89.6919972,18.5779988 90.26,18.814 C90.8280028,19.0500012 91.307998,19.3779979 91.7,19.798 C92.092002,20.2180021 92.389999,20.7199971 92.594,21.304 C92.798001,21.8880029 92.9,22.5279965 92.9,23.224 L92.9,31 L91.556,31 C91.2759986,31 91.0600008,30.9580004 90.908,30.874 C90.7559992,30.7899996 90.6360004,30.6200013 90.548,30.364 L90.284,29.476 C89.9719984,29.7560014 89.6680015,30.0019989 89.372,30.214 C89.0759985,30.4260011 88.7680016,30.6039993 88.448,30.748 C88.1279984,30.8920007 87.7860018,31.0019996 87.422,31.078 C87.0579982,31.1540004 86.6560022,31.192 86.216,31.192 C85.6959974,31.192 85.2160022,31.1220007 84.776,30.982 C84.3359978,30.8419993 83.9560016,30.6320014 83.636,30.352 C83.3159984,30.0719986 83.0680009,29.7240021 82.892,29.308 C82.7159991,28.8919979 82.628,28.4080028 82.628,27.856 C82.628,27.5439984 82.6799995,27.2340015 82.784,26.926 C82.8880005,26.6179985 83.0579988,26.3240014 83.294,26.044 C83.5300012,25.7639986 83.8359981,25.5000012 84.212,25.252 C84.5880019,25.0039988 85.0499973,24.7880009 85.598,24.604 C86.1460027,24.4199991 86.7839964,24.2700006 87.512,24.154 C88.2400036,24.0379994 89.0719953,23.9680001 90.008,23.944 L90.008,23.224 C90.008,22.3999959 89.8320018,21.790002 89.48,21.394 C89.1279982,20.997998 88.6200033,20.8 87.956,20.8 C87.4759976,20.8 87.0780016,20.8559994 86.762,20.968 C86.4459984,21.0800006 86.1680012,21.2059993 85.928,21.346 C85.6879988,21.4860007 85.470001,21.6119994 85.274,21.724 C85.077999,21.8360006 84.8600012,21.892 84.62,21.892 C84.411999,21.892 84.2360007,21.8380005 84.092,21.73 C83.9479993,21.6219995 83.8320004,21.4960007 83.744,21.352 L83.216,20.404 Z M103.412,21.832 C103.075998,21.423998 102.710002,21.1360008 102.314,20.968 C101.917998,20.7999992 101.492002,20.716 101.036,20.716 C100.587998,20.716 100.184002,20.7999992 99.824,20.968 C99.4639982,21.1360008 99.1560013,21.3899983 98.9,21.73 C98.6439987,22.0700017 98.4480007,22.5019974 98.312,23.026 C98.1759993,23.5500026 98.108,24.1679964 98.108,24.88 C98.108,25.6000036 98.1659994,26.2099975 98.282,26.71 C98.3980006,27.2100025 98.5639989,27.6179984 98.78,27.934 C98.9960011,28.2500016 99.2599984,28.4779993 99.572,28.618 C99.8840016,28.7580007 100.231998,28.828 100.616,28.828 C101.232003,28.828 101.755998,28.7000013 102.188,28.444 C102.620002,28.1879987 103.027998,27.8240024 103.412,27.352 L103.412,21.832 Z M106.376,13.168 L106.376,31 L104.564,31 C104.171998,31 103.924001,30.8200018 103.82,30.46 L103.568,29.272 C103.071998,29.8400028 102.502003,30.2999982 101.858,30.652 C101.213997,31.0040018 100.464004,31.18 99.608,31.18 C98.9359966,31.18 98.3200028,31.0400014 97.76,30.76 C97.1999972,30.4799986 96.718002,30.0740027 96.314,29.542 C95.909998,29.0099973 95.5980011,28.3520039 95.378,27.568 C95.1579989,26.7839961 95.048,25.888005 95.048,24.88 C95.048,23.9679954 95.1719988,23.1200039 95.42,22.336 C95.6680012,21.5519961 96.0239977,20.8720029 96.488,20.296 C96.9520023,19.7199971 97.5079968,19.2700016 98.156,18.946 C98.8040032,18.6219984 99.531996,18.46 100.34,18.46 C101.028003,18.46 101.615998,18.5679989 102.104,18.784 C102.592002,19.0000011 103.027998,19.2919982 103.412,19.66 L103.412,13.168 L106.376,13.168 Z M112.304,13.168 L112.304,31 L109.34,31 L109.34,13.168 L112.304,13.168 Z M123.2,23.428 C123.2,23.0439981 123.146001,22.6820017 123.038,22.342 C122.929999,22.0019983 122.768001,21.7040013 122.552,21.448 C122.335999,21.1919987 122.062002,20.9900007 121.73,20.842 C121.397998,20.6939993 121.012002,20.62 120.572,20.62 C119.715996,20.62 119.042002,20.8639976 118.55,21.352 C118.057998,21.8400024 117.744001,22.5319955 117.608,23.428 L123.2,23.428 Z M117.548,25.216 C117.596,25.8480032 117.707999,26.3939977 117.884,26.854 C118.060001,27.3140023 118.291999,27.6939985 118.58,27.994 C118.868001,28.2940015 119.209998,28.5179993 119.606,28.666 C120.002002,28.8140007 120.439998,28.888 120.92,28.888 C121.400002,28.888 121.813998,28.8320006 122.162,28.72 C122.510002,28.6079994 122.813999,28.4840007 123.074,28.348 C123.334001,28.2119993 123.561999,28.0880006 123.758,27.976 C123.954001,27.8639994 124.143999,27.808 124.328,27.808 C124.576001,27.808 124.759999,27.8999991 124.88,28.084 L125.732,29.164 C125.403998,29.5480019 125.036002,29.8699987 124.628,30.13 C124.219998,30.3900013 123.794002,30.5979992 123.35,30.754 C122.905998,30.9100008 122.454002,31.0199997 121.994,31.084 C121.533998,31.1480003 121.088002,31.18 120.656,31.18 C119.799996,31.18 119.004004,31.0380014 118.268,30.754 C117.531996,30.4699986 116.892003,30.0500028 116.348,29.494 C115.803997,28.9379972 115.376002,28.2500041 115.064,27.43 C114.751998,26.6099959 114.596,25.6600054 114.596,24.58 C114.596,23.7399958 114.731999,22.9500037 115.004,22.21 C115.276001,21.4699963 115.665997,20.8260027 116.174,20.278 C116.682003,19.7299973 117.301996,19.2960016 118.034,18.976 C118.766004,18.6559984 119.591995,18.496 120.512,18.496 C121.288004,18.496 122.003997,18.6199988 122.66,18.868 C123.316003,19.1160012 123.879998,19.4779976 124.352,19.954 C124.824002,20.4300024 125.193999,21.0139965 125.462,21.706 C125.730001,22.3980035 125.864,23.1879956 125.864,24.076 C125.864,24.5240022 125.816,24.8259992 125.72,24.982 C125.624,25.1380008 125.440001,25.216 125.168,25.216 L117.548,25.216 Z M148.832,23.296 L148.832,29.332 C147.983996,29.932003 147.080005,30.3919984 146.12,30.712 C145.159995,31.0320016 144.080006,31.192 142.88,31.192 C141.535993,31.192 140.328005,30.9860021 139.256,30.574 C138.183995,30.1619979 137.270004,29.5780038 136.514,28.822 C135.757996,28.0659962 135.178002,27.1520054 134.774,26.08 C134.369998,25.0079946 134.168,23.8160066 134.168,22.504 C134.168,21.1919934 134.365998,20.0020053 134.762,18.934 C135.158002,17.8659947 135.725996,16.9540038 136.466,16.198 C137.206004,15.4419962 138.099995,14.8580021 139.148,14.446 C140.196005,14.0339979 141.375993,13.828 142.688,13.828 C143.336003,13.828 143.933997,13.8719996 144.482,13.96 C145.030003,14.0480004 145.539998,14.1779991 146.012,14.35 C146.484002,14.5220009 146.923998,14.7339987 147.332,14.986 C147.740002,15.2380013 148.131998,15.5279984 148.508,15.856 L148.172,16.384 C148.059999,16.576001 147.892001,16.6200005 147.668,16.516 C147.547999,16.4679998 147.376001,16.3560009 147.152,16.18 C146.927999,16.0039991 146.620002,15.820001 146.228,15.628 C145.835998,15.435999 145.350003,15.2640008 144.77,15.112 C144.189997,14.9599992 143.484004,14.884 142.652,14.884 C141.547994,14.884 140.550004,15.0599982 139.658,15.412 C138.765996,15.7640018 138.006003,16.2679967 137.378,16.924 C136.749997,17.5800033 136.266002,18.3799953 135.926,19.324 C135.585998,20.2680047 135.416,21.3279941 135.416,22.504 C135.416,23.696006 135.585998,24.7679952 135.926,25.72 C136.266002,26.6720048 136.757997,27.4799967 137.402,28.144 C138.046003,28.8080033 138.827995,29.3159982 139.748,29.668 C140.668005,30.0200018 141.703994,30.196 142.856,30.196 C143.360003,30.196 143.825998,30.1640003 144.254,30.1 C144.682002,30.0359997 145.089998,29.9460006 145.478,29.83 C145.866002,29.7139994 146.241998,29.5700009 146.606,29.398 C146.970002,29.2259991 147.339998,29.0320011 147.716,28.816 L147.716,24.244 L144.464,24.244 C144.376,24.244 144.302,24.2160003 144.242,24.16 C144.182,24.1039997 144.152,24.0400004 144.152,23.968 L144.152,23.296 L148.832,23.296 Z M161.408,19.06 L161.408,31 L160.772,31 C160.571999,31 160.456,30.896001 160.424,30.688 L160.316,28.912 C159.763997,29.6000034 159.126004,30.1519979 158.402,30.568 C157.677996,30.9840021 156.872004,31.192 155.984,31.192 C155.319997,31.192 154.740002,31.088001 154.244,30.88 C153.747998,30.671999 153.336002,30.372002 153.008,29.98 C152.679998,29.587998 152.432001,29.1160028 152.264,28.564 C152.095999,28.0119972 152.012,27.3880035 152.012,26.692 L152.012,19.06 L153.164,19.06 L153.164,26.692 C153.164,27.8120056 153.419997,28.6899968 153.932,29.326 C154.444003,29.9620032 155.223995,30.28 156.272,30.28 C157.048004,30.28 157.773997,30.082002 158.45,29.686 C159.126003,29.289998 159.727997,28.7400035 160.256,28.036 L160.256,19.06 L161.408,19.06 Z M166.604,19.06 L166.604,31 L165.464,31 L165.464,19.06 L166.604,19.06 Z M167.096,14.944 C167.096,15.0880007 167.066,15.2219994 167.006,15.346 C166.946,15.4700006 166.868,15.5799995 166.772,15.676 C166.676,15.7720005 166.564001,15.8479997 166.436,15.904 C166.307999,15.9600003 166.172001,15.988 166.028,15.988 C165.883999,15.988 165.748001,15.9600003 165.62,15.904 C165.491999,15.8479997 165.38,15.7720005 165.284,15.676 C165.188,15.5799995 165.112,15.4700006 165.056,15.346 C165,15.2219994 164.972,15.0880007 164.972,14.944 C164.972,14.7999993 165,14.6620007 165.056,14.53 C165.112,14.3979993 165.188,14.2840005 165.284,14.188 C165.38,14.0919995 165.491999,14.0160003 165.62,13.96 C165.748001,13.9039997 165.883999,13.876 166.028,13.876 C166.172001,13.876 166.307999,13.9039997 166.436,13.96 C166.564001,14.0160003 166.676,14.0919995 166.772,14.188 C166.868,14.2840005 166.946,14.3979993 167.006,14.53 C167.066,14.6620007 167.096,14.7999993 167.096,14.944 Z M178.82,21.628 C178.363998,20.9399966 177.858003,20.4560014 177.302,20.176 C176.745997,19.8959986 176.112004,19.756 175.4,19.756 C174.695996,19.756 174.080003,19.8839987 173.552,20.14 C173.023997,20.3960013 172.582002,20.7579977 172.226,21.226 C171.869998,21.6940023 171.602001,22.2539967 171.422,22.906 C171.241999,23.5580033 171.152,24.2759961 171.152,25.06 C171.152,26.8360089 171.477997,28.1419958 172.13,28.978 C172.782003,29.8140042 173.723994,30.232 174.956,30.232 C175.740004,30.232 176.455997,30.028002 177.104,29.62 C177.752003,29.211998 178.323998,28.6400037 178.82,27.904 L178.82,21.628 Z M179.96,13.54 L179.96,31 L179.336,31 C179.127999,31 179.008,30.896001 178.976,30.688 L178.856,28.804 C178.327997,29.5240036 177.712004,30.0959979 177.008,30.52 C176.303996,30.9440021 175.512004,31.156 174.632,31.156 C173.159993,31.156 172.016004,30.6480051 171.2,29.632 C170.383996,28.6159949 169.976,27.0920102 169.976,25.06 C169.976,24.1879956 170.089999,23.3740038 170.318,22.618 C170.546001,21.8619962 170.879998,21.2060028 171.32,20.65 C171.760002,20.0939972 172.301997,19.6560016 172.946,19.336 C173.590003,19.0159984 174.331996,18.856 175.172,18.856 C175.980004,18.856 176.679997,19.0039985 177.272,19.3 C177.864003,19.5960015 178.379998,20.0359971 178.82,20.62 L178.82,13.54 L179.96,13.54 Z M192.272,23.824 C192.272,23.1839968 192.182001,22.6100025 192.002,22.102 C191.821999,21.5939975 191.568002,21.1640018 191.24,20.812 C190.911998,20.4599982 190.522002,20.1900009 190.07,20.002 C189.617998,19.8139991 189.120003,19.72 188.576,19.72 C187.959997,19.72 187.408002,19.815999 186.92,20.008 C186.431998,20.200001 186.010002,20.4759982 185.654,20.836 C185.297998,21.1960018 185.012001,21.6279975 184.796,22.132 C184.579999,22.6360025 184.436,23.1999969 184.364,23.824 L192.272,23.824 Z M184.304,24.556 L184.304,24.784 C184.304,25.6800045 184.407999,26.4679966 184.616,27.148 C184.824001,27.8280034 185.119998,28.3979977 185.504,28.858 C185.888002,29.3180023 186.351997,29.6639988 186.896,29.896 C187.440003,30.1280012 188.047997,30.244 188.72,30.244 C189.320003,30.244 189.839998,30.1780007 190.28,30.046 C190.720002,29.9139993 191.089999,29.7660008 191.39,29.602 C191.690002,29.4379992 191.927999,29.2900007 192.104,29.158 C192.280001,29.0259993 192.408,28.96 192.488,28.96 C192.592001,28.96 192.672,28.9999996 192.728,29.08 L193.04,29.464 C192.847999,29.7040012 192.594002,29.927999 192.278,30.136 C191.961998,30.344001 191.610002,30.5219993 191.222,30.67 C190.833998,30.8180007 190.418002,30.9359996 189.974,31.024 C189.529998,31.1120004 189.084002,31.156 188.636,31.156 C187.819996,31.156 187.076003,31.0140014 186.404,30.73 C185.731997,30.4459986 185.156002,30.0320027 184.676,29.488 C184.195998,28.9439973 183.826001,28.2780039 183.566,27.49 C183.305999,26.7019961 183.176,25.8000051 183.176,24.784 C183.176,23.9279957 183.297999,23.1380036 183.542,22.414 C183.786001,21.6899964 184.137998,21.0660026 184.598,20.542 C185.058002,20.0179974 185.621997,19.6080015 186.29,19.312 C186.958003,19.0159985 187.715996,18.868 188.564,18.868 C189.236003,18.868 189.859997,18.9839988 190.436,19.216 C191.012003,19.4480012 191.511998,19.7859978 191.936,20.23 C192.360002,20.6740022 192.693999,21.2199968 192.938,21.868 C193.182001,22.5160032 193.304,23.2599958 193.304,24.1 C193.304,24.2760009 193.28,24.3959997 193.232,24.46 C193.184,24.5240003 193.104001,24.556 192.992,24.556 L184.304,24.556 Z M202.976,20.536 C202.912,20.6480006 202.820001,20.704 202.7,20.704 C202.612,20.704 202.500001,20.6540005 202.364,20.554 C202.227999,20.4539995 202.046001,20.3420006 201.818,20.218 C201.589999,20.0939994 201.308002,19.9820005 200.972,19.882 C200.635998,19.7819995 200.228002,19.732 199.748,19.732 C199.315998,19.732 198.922002,19.7939994 198.566,19.918 C198.209998,20.0420006 197.906001,20.207999 197.654,20.416 C197.401999,20.624001 197.208001,20.8659986 197.072,21.142 C196.935999,21.4180014 196.868,21.7079985 196.868,22.012 C196.868,22.3880019 196.963999,22.6999988 197.156,22.948 C197.348001,23.1960012 197.597998,23.4079991 197.906,23.584 C198.214002,23.7600009 198.567998,23.9119994 198.968,24.04 C199.368002,24.1680006 199.773998,24.2959994 200.186,24.424 C200.598002,24.5520006 201.003998,24.6939992 201.404,24.85 C201.804002,25.0060008 202.157998,25.1999988 202.466,25.432 C202.774002,25.6640012 203.023999,25.9479983 203.216,26.284 C203.408001,26.6200017 203.504,27.0279976 203.504,27.508 C203.504,28.0280026 203.412001,28.5119978 203.228,28.96 C203.043999,29.4080022 202.774002,29.7959984 202.418,30.124 C202.061998,30.4520016 201.624003,30.711999 201.104,30.904 C200.583997,31.096001 199.988003,31.192 199.316,31.192 C198.475996,31.192 197.752003,31.0580013 197.144,30.79 C196.535997,30.5219987 195.992002,30.1720022 195.512,29.74 L195.776,29.332 C195.816,29.2679997 195.862,29.2200002 195.914,29.188 C195.966,29.1559998 196.036,29.14 196.124,29.14 C196.228001,29.14 196.353999,29.2039994 196.502,29.332 C196.650001,29.4600006 196.847999,29.5979993 197.096,29.746 C197.344001,29.8940007 197.649998,30.0319994 198.014,30.16 C198.378002,30.2880006 198.827997,30.352 199.364,30.352 C199.868003,30.352 200.311998,30.2820007 200.696,30.142 C201.080002,30.0019993 201.399999,29.8120012 201.656,29.572 C201.912001,29.3319988 202.105999,29.0500016 202.238,28.726 C202.370001,28.4019984 202.436,28.0600018 202.436,27.7 C202.436,27.299998 202.340001,26.9680013 202.148,26.704 C201.955999,26.4399987 201.704002,26.2160009 201.392,26.032 C201.079998,25.8479991 200.726002,25.6920006 200.33,25.564 C199.933998,25.4359994 199.528002,25.3080006 199.112,25.18 C198.695998,25.0519994 198.290002,24.9120008 197.894,24.76 C197.497998,24.6079992 197.144002,24.4160012 196.832,24.184 C196.519998,23.9519988 196.268001,23.6700017 196.076,23.338 C195.883999,23.0059983 195.788,22.5920025 195.788,22.096 C195.788,21.6719979 195.879999,21.264002 196.064,20.872 C196.248001,20.479998 196.509998,20.1360015 196.85,19.84 C197.190002,19.5439985 197.603998,19.3080009 198.092,19.132 C198.580002,18.9559991 199.127997,18.868 199.736,18.868 C200.464004,18.868 201.109997,18.971999 201.674,19.18 C202.238003,19.388001 202.751998,19.7079978 203.216,20.14 L202.976,20.536 Z" fill="#02303A"></path></g></svg></a>
            <button type="button" aria-label="Navigation Menu" class="site-header__navigation-button hamburger">
                <span class="hamburger__bar"></span>
                <span class="hamburger__bar"></span>
                <span class="hamburger__bar"></span>
            </button>
        </div>
        <div class="site-header__navigation-collapsible site-header__navigation-collapsible--collapse">
            <ul class="site-header__navigation-items">
                <li class="site-header__navigation-item site-header__navigation-submenu-section" tabindex="0">
                            <span class="site-header__navigation-link">
                                Docs
                                <svg class="site-header__down-arrow site-header__icon-light" width="19" height="11" viewBox="0 0 19 11" xmlns="http://www.w3.org/2000/svg"><title>Open Docs Menu</title><path transform="rotate(-180 9.374 5.494)" d="M17.9991 10.422825L9.3741 0.565575 0.7491 10.422825" stroke="#02303A" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/></svg>
                            </span>
                    <div class="site-header__navigation-submenu">
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://docs.gradle.org/current/userguide/userguide.html" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">User Manual</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://guides.gradle.org" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Guides and Tutorials</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://docs.gradle.org/current/dsl/" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">DSL Reference</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://docs.gradle.org/current/javadoc/" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Javadoc</span>
                            </a>
                        </div>
                        <div class="site-header__navigation-submenu-item" itemprop="name">
                            <a target="_top" class="site-header__navigation-submenu-item-link" href="https://docs.gradle.org/current/release-notes.html" itemprop="url">
                                <span class="site-header__navigation-submenu-item-link-text">Release Notes</span>
                            </a>
                        </div>
                    </div>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://discuss.gradle.org/" itemprop="url">Forums</a>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://gradle.org/training/" itemprop="url">Training</a>
                </li>
                <li class="site-header__navigation-item" itemprop="name">
                    <a target="_top" class="site-header__navigation-link" href="https://gradle.com/enterprise" itemprop="url">Try Gradle Enterprise</a>
                </li>
            </ul>
        </div>
    </nav>
</header>
<div id="header">
<h1>Improving the Performance of Gradle Builds</h1>
<div class="details">
<span id="author" class="author">Peter Ledbrook, Stefan Oehme, Tim Yates, FranÃ§ois Guillot, Craig Atkinson</span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Build performance is critical to your productivity. The longer the build takes to complete, the more likely you&#8217;ll be taken out of your development flow. On top of that, since you run the build many times a day, even small periods of waiting can add up to significant disruption. The same is true for builds run on CI: the faster they are, the faster you can react to new issues and the more capacity you will have to do innovative experiments.</p>
</div>
<div class="paragraph">
<p>All this means that itâs worth investing some time and effort into making your build as fast as possible. This guide offers several avenues you can explore to make a build faster, along with plenty of detail on what sorts of things can degrade the performance of a build and why.</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">Contents</div>
<ul class="sectlevel1">
<li><a href="#build_scans">Build scans</a></li>
<li><a href="#easy_improvements">Easy improvements</a></li>
<li><a href="#profiling_with_build_scans">Profiling with build scans</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#dependency_resolution">Dependency resolution</a></li>
<li><a href="#task_execution">Task execution</a></li>
<li><a href="#daemon">Daemon</a></li>
<li><a href="#suggestions_for_java_projects">Suggestions for Java projects</a></li>
<li><a href="#low_level_profiling">Low level profiling</a></li>
<li><a href="#suggestions_for_android_builds">Suggestions for Android builds</a></li>
<li><a href="#summary">Summary</a></li>
<li><a href="#help_improve_this_guide">Help improve this guide</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="build_scans"><a class="anchor" href="#build_scans"></a><a class="link" href="#build_scans">Build scans</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://gradle.com/build-scans">Build scans</a> are a persistent, shareable record of what happened when running a build. With build scans, you gain deep insights about your build to identify and fix performance bottlenecks.</p>
</div>
<div class="paragraph">
<p>If you are using Gradle 4.3+, you can easily create a build scan by using the <code>--scan</code> command line option, e.g. <code>gradle build --scan</code>.
For older Gradle versions, see the <a href="https://docs.gradle.com/build-scan-plugin/#getting_set_up">Build Scan Plugin User Manual</a> on how to enable build scans.</p>
</div>
<div class="paragraph">
<p>Gradle displays the URL where your build scan is available at the end of the build execution:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/build-scan-url.png" alt="build scan url">
</div>
<div class="title">Figure 1. Build scan link at end of the build output</div>
</div>
<div class="paragraph">
<p>Next, the guide will cover some quick improvements that can increase your build&#8217;s performance. After that will be a deeper dive into profiling your build with build scans.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="easy_improvements"><a class="anchor" href="#easy_improvements"></a><a class="link" href="#easy_improvements">Easy improvements</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A guide on performance tuning would normally start with profiling and something about premature optimisation being the root of all evil. Profiling is definitely important and the guide discusses it later, but there are some things you can do that will impact all your builds for the better at the flick of a switch.</p>
</div>
<div class="sect2">
<h3 id="use_latest_gradle_and_jvm_versions"><a class="anchor" href="#use_latest_gradle_and_jvm_versions"></a><a class="link" href="#use_latest_gradle_and_jvm_versions">Use latest Gradle and JVM versions</a></h3>
<div class="paragraph">
<p>The Gradle team works continuously on improving the performance of different aspects of Gradle builds. If youâre using an old version of Gradle, youâre missing out on the benefits of that work. Always keep up with Gradle version upgrades. Doing so is low risk because the Gradle team ensures backwards compatibility between minor versions of Gradle. Staying up-to-date also makes transitioning to the next major version easier, because you&#8217;ll get early deprecation warnings.</p>
</div>
<div class="paragraph">
<p>Going up a major version is often just as easy. Only formerly deprecated APIs and deprecated behavior become failures at these boundaries. So be sure to fix those deprecation warnings! If they are caused by a third party plugin, let the author know right away, so you are not blocked when the next major release comes out.</p>
</div>
<div class="paragraph">
<p>As Gradle runs on the JVM, improvements in the performance of the latter will often benefit Gradle. Hence, you should consider running Gradle with the latest major version of the JVM.</p>
</div>
</div>
<div class="sect2">
<h3 id="parallel_execution"><a class="anchor" href="#parallel_execution"></a><a class="link" href="#parallel_execution">Parallel execution</a></h3>
<div class="paragraph">
<p>Most builds consist of more than one project and some of those projects are usually independent of one another. Yet Gradle will only run one task at a time by default, regardless of the project structure (this will be improved soon). By using the <code>--parallel</code> switch, you can force Gradle to execute tasks in parallel as long as those tasks are in different projects.</p>
</div>
<div class="paragraph">
<p>You could see big improvements in build times as soon as you enable parallel builds. The extent of those improvements depends on your project structure and how many dependencies you have between them. A build whose execution time is dominated by a single project won&#8217;t benefit much at all, for example. Or one that has lots of inter-project dependencies resulting in few tasks that can be executed in parallel. But most multi-project builds should see a worthwhile boost to build times.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Parallel builds require projects to be decoupled at execution time, i.e. tasks in different projects must not modify shared state. Read more about that topic in <a href="https://docs.gradle.org/current/userguide/multi_project_builds.html#sec:parallel_execution">the User Manual</a> before using <code>--parallel</code> extensively. Also be aware that Gradle versions before 4.0 could run <code>clean</code> and <code>build</code> tasks in parallel, resulting in failures. On these older versions it is best to call <code>clean</code> separately.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also make building in parallel the default for a project by adding the following setting to the project&#8217;s <em>gradle.properties</em> file:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">org.gradle.parallel=<span class="predefined-constant">true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Build scans give you a visual timeline of task execution and a quick impression on the current degree of parallelism, allowing you to identify and remove bottlenecks.</p>
</div>
<div class="paragraph">
<p>For example, in the following example build you can see long-running tasks at the beginning and end of the build where they are the only tasks being executed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/parallel-task-slow.png" alt="parallel task slow">
</div>
<div class="title">Figure 2. Bottleneck in parallel execution</div>
</div>
<div class="paragraph">
<p>Tweaking the build configuration to run the two slow tasks early on and in parallel reduces the overall build time from 8 seconds down to 5 seconds:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/parallel-task-fast.png" alt="parallel task fast">
</div>
<div class="title">Figure 3. Optimized parallel execution</div>
</div>
</div>
<div class="sect2">
<h3 id="configure_on_demand"><a class="anchor" href="#configure_on_demand"></a><a class="link" href="#configure_on_demand">Configure on demand</a></h3>
<div class="paragraph">
<p>Imagine you have 300 subprojects all managed by a single Gradle build. Even if the configuration time for each project is just 50ms, that means every build will take at least 15s! Thatâs why itâs particularly crucial to keep a close eye on configuration times for projects that have a lot of modules.</p>
</div>
<div class="paragraph">
<p>With that in mind, wouldnât it be better if Gradle only configured the projects that were actually required to execute the requested task(s)? Of course, and thatâs where the <code>--configure-on-demand</code> command line option comes in. It avoids a lot of unnecessary configuration at the cost of working out which projects are required. While not necessarily recommended if you only have a small number of quick-to-configure subprojects, it can be worth a try in larger builds.</p>
</div>
<div class="paragraph">
<p>Configure on demand will only work reliably when you have decoupled projects. You can learn more about <a href="https://docs.gradle.org/current/userguide/multi_project_builds.html#sec:decoupled_projects">decoupled projects</a> in the User Manual. Most importantly, using <code>subprojects {}</code> or <code>allprojects {}</code> blocks will mostly negate the benefit of configure-on-demand, because those blocks are executed eagerly.</p>
</div>
<div class="paragraph">
<p>You can make configure on demand the default for a project by adding the following setting to its <em>gradle.properties</em> file:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">org.gradle.configureondemand=<span class="predefined-constant">true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Thatâs the end of the quick wins. From here on out, improving your build performance will require some elbow grease. First, perhaps the most important step: finding out which bits of your build are slow and why.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="profiling_with_build_scans"><a class="anchor" href="#profiling_with_build_scans"></a><a class="link" href="#profiling_with_build_scans">Profiling with build scans</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using build scans in the context of profiling a build, the main area of interest in the early stages of diagnosis is the performance page. To get there, click <em>"Performance"</em>&nbsp; in the left hand navigation menu, or follow the link highlighted in the following screenshot of the build scan home page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/build-scan-home.png" alt="build scan home">
</div>
<div class="title">Figure 4. Performance page link on build scan home page</div>
</div>
<div class="paragraph">
<p>The performance page gives you a breakdown of how long different stages of your build took to complete. As you can see from the following screenshot, you get to see how long Gradle took to start up, configure the build&#8217;s projects, resolve dependencies, and execute the tasks. You also get details about environmental properties, such as whether a daemon was used or not.</p>
</div>
<div id="build-scan-performance" class="imageblock">
<div class="content">
<img src="images/build-scan-performance-page.png" alt="build scan performance page">
</div>
<div class="title">Figure 5. Build scan performance page</div>
</div>
<div class="paragraph">
<p>In addition to the top-level performance summary of your build execution, you can drill down further into individual aspects that affect build performance in the different tabs of the performance page.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a><a class="link" href="#configuration">Configuration</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>As the user guide describes in <a href="https://docs.gradle.org/current/userguide/build_lifecycle.html">the build lifecycle chapter</a>, a Gradle build goes through 3 phases: initialization, configuration, and execution. The important thing to understand here is that configuration code always executes regardless of which tasks will run. That means any expensive work performed during configuration will slow every invocation down, even simple ones like <code>gradle help</code> and <code>gradle tasks</code>.</p>
</div>
<div class="paragraph">
<p>In the above <a href="#build-scan-performance">Build scan performance page</a>, you can see that build configuration is taking over 16 seconds. Clicking on the <em>"Configuration"</em>&nbsp; tab at the top of the page will break this stage down into its component parts, exposing what is causing any slowness.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/build-scan-configuration-breakdown.png" alt="build scan configuration breakdown">
</div>
<div class="title">Figure 6. Build scan configuration breakdown</div>
</div>
<div class="paragraph">
<p>Here you can see the scripts and plugins that were applied to the project in descending order of how long they took to apply. The slowest plugin and script applications are good candidates for optimization, and you can dig further into those items in the list. For example, the script <code>script-b.gradle</code> was applied once but took 3 seconds - you can expand that row to see how and where this was applied to the build.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/script-b-application.png" alt="script b application">
</div>
<div class="title">Figure 7. Showing the application of script-b.gradle to the build</div>
</div>
<div class="paragraph">
<p>You can see that this script is applied once, by the project <code>:app1</code> from inside of that project&#8217;s <code>build.gradle</code> file.</p>
</div>
<div class="paragraph">
<p>The next few subsections introduce techniques that can help improve the configuration time and explain why they work.</p>
</div>
<div class="sect2">
<h3 id="apply_plugins_judiciously"><a class="anchor" href="#apply_plugins_judiciously"></a><a class="link" href="#apply_plugins_judiciously">Apply plugins judiciously</a></h3>
<div class="paragraph">
<p>Every plugin and script that you apply to a project adds to the overall configuration time. Some plugins have a greater impact than others. That doesnât mean you should avoid using plugins, but you should take care to only apply them where theyâre needed. For example, itâs easy to apply plugins to all projects via <code>allprojects {}</code> or <code>subprojects {}</code> even if not every project needs them.</p>
</div>
<div class="paragraph">
<p>In the above build scan example, you can see that the script <code>script-a.gradle</code> is applied to 3 projects inside the build:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/script-a-application.png" alt="script a application">
</div>
<div class="title">Figure 8. Showing the application of script-a.gradle to the build</div>
</div>
<div class="paragraph">
<p>This script takes 1 second to run, and as it is applied to 3 projects from the root <code>build.gradle</code> file, it is introducing a 3 second delay to the configuration phase.</p>
</div>
<div class="paragraph">
<p>Ideally, plugins and scripts should not incur a significant configuration-time cost. If they do, the focus should be on improving them. Nonetheless, in projects with many modules and a significant configuration time, you should spend a little time identifying any plugins that have a notable impact.</p>
</div>
</div>
<div class="sect2">
<h3 id="avoid_expensive_or_blocking_work"><a class="anchor" href="#avoid_expensive_or_blocking_work"></a><a class="link" href="#avoid_expensive_or_blocking_work">Avoid expensive or blocking work</a></h3>
<div class="paragraph">
<p>As you&#8217;ve seen, you&#8217;ll want to avoid doing time-intensive work in the configuration phase, but sometimes it can sneak into your build in non-obvious places. Itâs usually clear when youâre encrypting data or calling remote services during configuration if that code is in a build file. But logic like this is more often found in plugins and occasionally custom task classes. Any expensive work in a plugin&#8217;s <code>apply()</code> method or a tasks&#8217;s constructor should be a red flag. The most common and less obvious mistake is resolving dependencies at configuration time, which is covered in its own chapter further below.</p>
</div>
</div>
<div class="sect2">
<h3 id="statically_compile_tasks_and_plugins"><a class="anchor" href="#statically_compile_tasks_and_plugins"></a><a class="link" href="#statically_compile_tasks_and_plugins">Statically compile tasks and plugins</a></h3>
<div class="paragraph">
<p>Plugins and occasionally tasks perform work during the configuration phase. These are often written in Groovy for its concise syntax, API extensions to the JDK, and functional methods using closures. However, itâs important to bear in mind that there is a small cost associated with method calls in dynamic Groovy. When you have lots of method calls repeated across lots of projects, the cost can add up.</p>
</div>
<div class="paragraph">
<p>That cost can be reduced by using <code>@CompileStatic</code> on your Groovy classes (where possible) or writing those classes in a statically compiled language, such as Java. This only really applies to large projects or plugins that you publish publicly (because they may be applied to large projects by other users). If you do need dynamic Groovy at any point, simply use <code>@CompileDynamic</code> for the relevant methods.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> The DSL youâre used to in the build script relies heavily on Groovyâs dynamic features, so if you want to use static compilation in your plugins, you will have to switch to more traditional Java-like syntax. For example, to create a new copy task, you would use code like this:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">project.tasks.create(<span class="string"><span class="delimiter">&quot;</span><span class="content">copyFiles</span><span class="delimiter">&quot;</span></span>, Copy) { Task t -&gt;
    t.into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>project.buildDir<span class="inline-delimiter">}</span></span><span class="content">/output</span><span class="delimiter">&quot;</span></span>
    t.from project.configurations.getByName(<span class="string"><span class="delimiter">&quot;</span><span class="content">compile</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see how this example uses the <code>create()</code> and <code>getByName()</code> methods, which are available on all Gradle âdomain object containersâ, like tasks, configurations, dependencies, extensions, etc. Some collections have dedicated types, <code>TaskContainer</code> being one of them, that have useful extra methods like the <code>create()</code> method above that takes a task type.</p>
</div>
<div class="paragraph">
<p>If you do decide to use static compilation, using an IDE can quickly show errors due to unrecognised types, properties, and methods. Youâll also get auto-completion, which is always handy.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dependency_resolution"><a class="anchor" href="#dependency_resolution"></a><a class="link" href="#dependency_resolution">Dependency resolution</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Software projects rely on dependency resolution to simplify the integration of third-party libraries and other dependencies into the build. This does come at a cost as Gradle has to contact remote servers to find out about these dependencies and download them where necessary. Advanced caching helps speed things up tremendously, but you still need to watch out for a few pitfalls that are discussed next.</p>
</div>
<div class="sect2">
<h3 id="minimize_dynamic_and_snapshot_versions"><a class="anchor" href="#minimize_dynamic_and_snapshot_versions"></a><a class="link" href="#minimize_dynamic_and_snapshot_versions">Minimize dynamic and snapshot versions</a></h3>
<div class="paragraph">
<p>Dynamic versions, such as â2.+â, and snapshot (or changing) versions force Gradle to contact the remote repository to find out whether thereâs a new version or snapshot available. By default, Gradle will only perform the check once every 24 hours, but this can be changed. Look out for <code>cacheDynamicVersionsFor</code> and <code>cacheChangingModulesFor</code> in your build files and initialization scripts in case they are set to very short periods or disabled completely. Otherwise you may be condemning your build users to frequent slower-than-normal builds rather than a single slower-than-normal build a day.</p>
</div>
<div class="paragraph">
<p>You can find all dependencies with dynamic versions via build scans:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/dependency-dynamic-versions.png" alt="dependency dynamic versions">
</div>
<div class="title">Figure 9. Find dependencies with dynamic versions</div>
</div>
<div class="paragraph">
<p>You may be able to use fixed versions -&nbsp;like â1.2â and â3.0.3.GAâ&nbsp;- in which case Gradle will always use the cached version. But if you need to use dynamic and snapshot versions, make sure you tune the cache settings to best meet your needs.</p>
</div>
</div>
<div class="sect2">
<h3 id="don_t_resolve_dependencies_at_configuration_time"><a class="anchor" href="#don_t_resolve_dependencies_at_configuration_time"></a><a class="link" href="#don_t_resolve_dependencies_at_configuration_time">Don&#8217;t resolve dependencies at configuration time</a></h3>
<div class="paragraph">
<p>Dependency resolution is an expensive process, both in terms of I/O and computation. Gradle reduces -&nbsp;and eliminates in some cases&nbsp;- the required network traffic through judicious caching, but there is still work it needs to do. Why is this important? Because if you trigger dependency resolution during the configuration phase, youâre going to add a penalty to every build that runs.</p>
</div>
<div class="paragraph">
<p>The key question to answer is what triggers dependency resolution? The most common cause is the evaluation of the files that make up a configuration. This is normally a job for tasks, since you typically donât need the files until youâre ready to do something with them in a task action. However, imagine youâre doing some debugging and want to display the files that make up a configuration. One way you can do this is by injecting a print statement:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyFiles(<span class="key">type</span>: Copy) {
    println <span class="string"><span class="delimiter">&quot;</span><span class="content">&gt;&gt; Compilation deps: </span><span class="inline"><span class="inline-delimiter">${</span>configurations.compile.files<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/output</span><span class="delimiter">&quot;</span></span>
    from configurations.compile
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>files</code> property will force Gradle to resolve the dependencies, and in this example thatâs happening during the configuration phase. Now every time you run the build, no matter what tasks you execute, you&#8217;ll take a performance hit from the dependency resolution on that configuration. It would be better to add this in a <code>doFirst()</code> action.</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">task copyFiles(<span class="key">type</span>: Copy) {
    into <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">$</span>buildDir</span><span class="content">/output</span><span class="delimiter">&quot;</span></span>
    from configurations.compile
    doFirst {
        println <span class="string"><span class="delimiter">&quot;</span><span class="content">&gt;&gt; Compilation deps: </span><span class="inline"><span class="inline-delimiter">${</span>configurations.compile.files<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>from()</code> declaration doesnât resolve the dependencies because youâre using the <a href="https://docs.gradle.org/current/userguide/artifact_dependencies_tutorial.html#configurations">dependency configuration</a> itself as an argument, not its files. The <code>Copy</code> task handles the resolution of the configuration itself during task execution, which is exactly what you want.</p>
</div>
<div class="paragraph">
<p>The "Dependency resolution" tab on the performance page of a build scan explicitly shows how dependency resolution time is split across project configuration and task execution:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/bad-dependency-resolution.png" alt="bad dependency resolution">
</div>
<div class="title">Figure 10. Dependency resolution at configuration time</div>
</div>
<div class="paragraph">
<p>Here, you can quickly identify the cause of this particular performance issue. The time spent resolving dependencies during <em>"project configuration"</em>&nbsp; should be 0&nbsp;seconds, and this example shows the build is resolving dependencies too early in the lifecycle.  Also on the "Performance" page is a "Settings and suggestions" tab which will show you which dependencies were being resolved during project configuration.</p>
</div>
<div class="paragraph">
<p>If you are using the profiler, you can get similar (but less detailed) information can by running this command:</p>
</div>
<div class="listingblock terminal">
<div class="content">
<pre>$ gradle --profile help</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="avoid_unnecessary_and_unused_dependencies"><a class="anchor" href="#avoid_unnecessary_and_unused_dependencies"></a><a class="link" href="#avoid_unnecessary_and_unused_dependencies">Avoid unnecessary and unused dependencies</a></h3>
<div class="paragraph">
<p>You will sometimes encounter situations in which you&#8217;re only using one or two methods or classes from a third-party library. When that happens, you should seriously consider implementing the required code yourself in the project or copying it from an open source library if that&#8217;s an option for you. Remember that managing third-party libraries and their transitive dependencies adds a not insignificant cost to project maintenance as well as build times.</p>
</div>
<div class="paragraph">
<p>Another thing to watch out for is the existence of <em>unused dependencies</em>. This can easily happen after code refactoring when a third-party library stops being used but isn&#8217;t removed from the dependency list. You can use the <a href="https://github.com/nebula-plugins/gradle-lint-plugin">Gradle Lint plugin</a> to identify such dependencies.</p>
</div>
</div>
<div class="sect2">
<h3 id="minimize_repository_count"><a class="anchor" href="#minimize_repository_count"></a><a class="link" href="#minimize_repository_count">Minimize repository count</a></h3>
<div class="paragraph">
<p>When Gradle attempts to resolve a dependency, it searches through each repository in the order that they are declared until it finds that dependency. This generally means that you want to declare the repository hosting the largest number of your dependencies first so that only that repository is searched in the majority of cases. You should also limit the number of declared repositories to the minimum viable number for your build to work.</p>
</div>
<div class="paragraph">
<p>One technique available if you&#8217;re using a custom repository server is to create a virtual repository that aggregates several real repositories together. You can then add just that repository to your build file, further reducing the number of HTTP requests that Gradle sends during dependency resolution.</p>
</div>
</div>
<div class="sect2">
<h3 id="be_careful_with_custom_dependency_resolution_logic"><a class="anchor" href="#be_careful_with_custom_dependency_resolution_logic"></a><a class="link" href="#be_careful_with_custom_dependency_resolution_logic">Be careful with custom dependency resolution logic</a></h3>
<div class="paragraph">
<p>Dependency resolution is a hard problem to solve and making it perform well simply adds to the challenge. And yet, Gradle still needs to allow users to model dependency resolution in the way that best suits them. That&#8217;s why it has a powerful API for customizing how the dependency resolution works.</p>
</div>
<div class="paragraph">
<p>Simple customizations&#8201;&#8212;&#8201;such as forcing specific versions of a dependency or substituting one dependency for another&#8201;&#8212;&#8201;don&#8217;t have a big impact on dependency resolution times. But if custom logic involves downloading and parsing extra POMs, for example, then the impact can be significant.</p>
</div>
<div class="paragraph">
<p>You should use build scans or profile reports to check that any custom dependency resolution logic you have in your build doesn&#8217;t adversely affect dependency resolution times in a big way. And note that this could be custom logic you have written yourself or it could be part of a plugin that you&#8217;re using.</p>
</div>
</div>
<div class="sect2">
<h3 id="identify_slow_or_unexpected_dependency_downloads"><a class="anchor" href="#identify_slow_or_unexpected_dependency_downloads"></a><a class="link" href="#identify_slow_or_unexpected_dependency_downloads">Identify slow or unexpected dependency downloads</a></h3>
<div class="paragraph">
<p>Slow dependency downloads (potentially caused by a slow internet connection, overloaded repository server, or similar) can impact your overall build performance. Build scans provide a "Network Activity" tab on the "Performance" page that lists helpful information such as the time spent downloading dependencies, overall transfer rate of dependency downloads across your build, and a list of downloads sorted by download time.</p>
</div>
<div class="paragraph">
<p>Here you can see two slow dependency downloads that took 20 and 40 seconds and slowed down the overall performance in the build:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/slow-dependency-downloads.png" alt="slow dependency downloads">
</div>
<div class="title">Figure 11. Identify slow dependency downloads</div>
</div>
<div class="paragraph">
<p>You can also check the download list to make sure that there weren&#8217;t any dependency downloads that you didn&#8217;t expect during the build execution. For example, you might see an unexpected download caused by a dependency using a dynamic version.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="task_execution"><a class="anchor" href="#task_execution"></a><a class="link" href="#task_execution">Task execution</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fastest task is one that doesnât execute. If you can find ways to skip tasks you donât need to run, youâll end up with a faster build overall. This section will discuss a few ways to achieve task avoidance in your Gradle build.</p>
</div>
<div class="sect2">
<h3 id="different_people_different_builds"><a class="anchor" href="#different_people_different_builds"></a><a class="link" href="#different_people_different_builds">Different people, different builds</a></h3>
<div class="paragraph">
<p>It seems to be very common to treat a build as an all or nothing package. Every user has to learn the same set of tasks that have been defined by the build. In many cases this makes no sense. Imagine you have both front-end and back-end developers: do they want the same things from the build? Of course not, particularly if one side is HTML, CSS and Javascript, while the other is Java and servlets.</p>
</div>
<div class="paragraph">
<p>Itâs important that a single task graph underpins the build to ensure consistency. But you donât need to expose the entire task graph to everyone. Instead, think in terms of sets of tasks forming a restricted view upon the task graph, with each view designed for a specific group of users. Do front-end developers need to run the server side unit tests? No, so it would make no sense to force the cost of running the tests on those users.</p>
</div>
<div class="paragraph">
<p>With that in mind, consider the different workflows that each distinct group of users require and try to ensure that they have the appropriate âviewâ with no unnecessary tasks executed. Gradle has several ways to aid you in such an endeavour:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Assign tasks to appropriate groups</p>
</li>
<li>
<p>Create useful aggregate tasks (ones that have no action and simply depend on a set of other tasks, like <code>assemble</code>)</p>
</li>
<li>
<p>Defer configuration via <code>gradle.taskGraph.whenReady()</code> and others, so you can perform verification only when it&#8217;s necessary</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It definitely requires some effort and an investment in time to craft suitable build views, but think about how often users run the build. Surely that investment is worth it if it saves users time on a daily basis?</p>
</div>
</div>
<div class="sect2">
<h3 id="incremental_build"><a class="anchor" href="#incremental_build"></a><a class="link" href="#incremental_build">Incremental build</a></h3>
<div class="paragraph">
<p>You can can avoid executing tasks, even if theyâre required by a user. If neither a taskâs inputs nor its output have changed since the last time it was run, Gradle will not run it again.</p>
</div>
<div class="paragraph">
<p>Incremental build is the name Gradle gives to this feature of checking inputs and outputs to determine whether a task needs to run again or not. Most tasks provided by Gradle take part in incremental build because they have been defined that way. You can also make your own tasks integrate with incremental build, as described in the user guide. The basic idea is to mark the taskâs properties that have an impact on whether a task needs to run. You can learn more <a href="https://docs.gradle.org/current/userguide/more_about_tasks.html#sec:up_to_date_checks">in the user guide</a>.</p>
</div>
<div class="paragraph">
<p>You can easily identify good candidates for participation in incremental builds, and learn why tasks were not up to date when you expected them to be by looking at the timeline view in a build scan:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/timeline.png" alt="timeline">
</div>
<div class="title">Figure 12. The timeline view can help with incremental build inspection</div>
</div>
<div class="paragraph">
<p>As you can see in the build scan above, the task was not up-to-date because one of its inputs <em>"timestamp"</em>&nbsp; has changed, and is forcing the task to be re-run.</p>
</div>
<div class="paragraph">
<p>The tasks can also be sorted by longest duration first, making it easy to pick out the slowest tasks. Pick the slowest of your custom tasks and make it participate in incremental builds, then measure again and repeat.</p>
</div>
</div>
<div class="sect2">
<h3 id="caching_task_outputs"><a class="anchor" href="#caching_task_outputs"></a><a class="link" href="#caching_task_outputs">Caching task outputs</a></h3>
<div class="paragraph">
<p>Incremental build works locally, based on the previous execution of a task. Gradle can also store task outputs in a <em>build cache,</em> and retrieve them later when the same task with the same inputs is about to be executed. You can use a local cache to reuse task outputs on your computer. This helps reduce build times when switching branches.</p>
</div>
<div class="paragraph">
<p>It is also possible to use a shared build cache service, like <a href="https://gradle.com/build-cache/">the one provided by Gradle Enterprise</a>. Shared caches can reduce the number of tasks you need to execute by reusing outputs already generated elsewhere. This can significantly decrease build times for both CI and developer builds.</p>
</div>
<div class="paragraph">
<p>For extensive information about leveraging the build cache in your build, check out the complete guide about <a href="https://guides.gradle.org/using-build-cache/">using the build cache</a>. It covers the different scenarios caching can improve, and detailed discussions of the different caveats you need to be aware of when enabling caching for a build.</p>
</div>
<div class="paragraph">
<p>Again, build scans can help you investigate how well your tasks are caching. In the performance screen, there is a tab titled <em>"Build cache"</em>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/cache-performance.png" alt="cache performance">
</div>
<div class="title">Figure 13. Inspecting the performance of the build cache for a build</div>
</div>
<div class="paragraph">
<p>This shows you statistics about how many tasks interacted with a cache, which cache was used, along with transfer and pack/unpack rates for these cache entries.</p>
</div>
<div class="paragraph">
<p>There is also a <em>"Task execution"</em>&nbsp; tab which shows details including cacheablity of the tasks that were executed. Clicking on any of the categories will take you to the Timeline screen with just tasks of that category highlighted.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/task-execution-cacheable.png" alt="task execution cacheable">
</div>
<div class="title">Figure 14. A task oriented view of performance</div>
</div>
<div class="imageblock">
<div class="content">
<img src="images/timeline-not-cacheable.png" alt="timeline not cacheable">
</div>
<div class="title">Figure 15. Timeline screen with 'not cacheable' tasks only</div>
</div>
<div class="paragraph">
<p>Subsequently sorting by task duration on the Timeline screen will highlight tasks with great potential for time saving. The build scan above shows that <code>:task1</code> and <code>:task3</code> could be improved and made cacheable, and clearly states the reason why they were considered not cacheable.</p>
</div>
</div>
<div class="sect2">
<h3 id="partial_builds"><a class="anchor" href="#partial_builds"></a><a class="link" href="#partial_builds">Partial builds</a></h3>
<div class="paragraph">
<p>Incremental build definitely improves build times, but you need to remember that the up-to-date checks still take time. This has important implications for multi-project builds that have a large number of subprojects. If the task you want to execute ultimately depends on the execution of twenty other subprojects, you have to wait until the build has finished checking those before it gets round to your task. Some of them may even have non-incremental tasks that end up running, even if nothing has changed.</p>
</div>
<div class="paragraph">
<p>Gradle offers a nice shortcut if you know that a task&#8217;s project dependencies haven&#8217;t changed: use the <code>-a</code> command line option. This forces Gradle to effectively ignore all the dependent projects and only execute the required tasks that are defined in the target project. Project dependencies will still be included on the appropriate classpaths, so the project will build as before. Just be sure there haven&#8217;t been any changes to the projects the target depends on!</p>
</div>
<div class="paragraph">
<p>Gradle also supports other forms of partial build via the <em>base</em> plugin, which adds the following tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>buildNeeded</code> - will execute the <code>build</code> task in the target project and all those projects it depends on. This verifies that the projects you depend on are working correctly. If that&#8217;s not the case, they may break the target project&#8217;s tests or some other part of the build.</p>
</li>
<li>
<p><code>buildDependents</code> - will execute the <code>build</code> task in the target project and all projects that depend on it. This checks that you haven&#8217;t broken those projects after making some changes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These tasks are slower than just running <code>build</code> in the target project as they do more work, but they are an effective alternative to running <code>gradle build</code>, which runs <code>build</code> in <em>all</em> the projects of a multi-project build.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="daemon"><a class="anchor" href="#daemon"></a><a class="link" href="#daemon">Daemon</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="enable_the_daemon_on_old_gradle_versions"><a class="anchor" href="#enable_the_daemon_on_old_gradle_versions"></a><a class="link" href="#enable_the_daemon_on_old_gradle_versions">Enable the daemon on old Gradle versions</a></h3>
<div class="paragraph">
<p>The Gradle daemon is a mechanism for improving the performance of Gradle. As of Gradle 3.0, the daemon is enabled by default, but if you are using an older version, you should definitely enable it on local developer machines. You will see big improvements in build speed by doing so. You can learn how to do that <a href="https://docs.gradle.org/2.14/userguide/gradle_daemon.html">in the 2.14 user guide</a>.</p>
</div>
<div class="paragraph">
<p>On CI machines the benefit you can expect from the daemon depends on your setup. If you have long-lived CI agents and you build lots of small projects that all use the same Gradle version and JVM arguments, then the daemon can reduce your turnarounds. If your projects are big or more diverse, you probably won&#8217;t see much benefit. Generally it is safe to leave the daemon on, as Gradle 3.0 introduced health monitoring which will shut daemons down on memory pressure.</p>
</div>
</div>
<div class="sect2">
<h3 id="adjust_the_daemon_s_heap_size"><a class="anchor" href="#adjust_the_daemon_s_heap_size"></a><a class="link" href="#adjust_the_daemon_s_heap_size">Adjust the daemon&#8217;s heap size</a></h3>
<div class="paragraph">
<p>By default Gradle will reserve 1GB of heap space for your build, which is plenty for most projects, especially if you follow
our advice on forked compilation further down in this guide. However, some very large builds might need more memory to hold Gradle&#8217;s model and caches. If this is the case for you, you can check in this larger memory requirement in your <em>gradle.properties</em> file:</p>
</div>
<div class="listingblock">
<div class="title">gradle.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">org.gradle.jvmargs=-Xmx2048M</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="suggestions_for_java_projects"><a class="anchor" href="#suggestions_for_java_projects"></a><a class="link" href="#suggestions_for_java_projects">Suggestions for Java projects</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following suggestions are specific to projects using the <code>java</code> plugin or one of the other JVM languages.</p>
</div>
<div class="sect2">
<h3 id="running_tests"><a class="anchor" href="#running_tests"></a><a class="link" href="#running_tests">Running tests</a></h3>
<div class="paragraph">
<p>A significant proportion of the build time for many projects consists of the test tasks that run. These could be a mixture of unit and integration tests, with the latter often being significantly slower. Build scans can help you identify the slowest tests, which should be the primary focus of your performance improvements.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/tests-longest.png" alt="tests longest">
</div>
<div class="title">Figure 16. Tests screen, with tests by project, sorted by duration</div>
</div>
<div class="paragraph">
<p>As shown above, build scans provide an interactive test report, across all projects in which tests ran.</p>
</div>
<div class="paragraph">
<p>Gradle has a few ways to help your tests complete faster:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Parallel test execution</p>
</li>
<li>
<p>Process forking options</p>
</li>
<li>
<p>Disable report generation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Letâs look at each of these in turn.</p>
</div>
<div class="sect3">
<h4 id="parallel_test_execution"><a class="anchor" href="#parallel_test_execution"></a><a class="link" href="#parallel_test_execution">Parallel test execution</a></h4>
<div class="paragraph">
<p>Gradle will happily run multiple test cases in parallel, which is useful when you have several CPU cores and donât want to waste most of them. To enable this feature, just use the following configuration setting on the relevant <code>Test</code> task(s):</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test.maxParallelForks = <span class="integer">4</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The normal approach is to use some number less than or equal to the number of CPU cores you have, such as this algorithm:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test.maxParallelForks = <span class="predefined-type">Runtime</span>.runtime.availableProcessors().intdiv(<span class="integer">2</span>) ?: <span class="integer">1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that if you do run the tests in parallel, you will have to ensure that they are independent, i.e. donât share resources, be that files, databases or something else. Otherwise there is a chance that the tests will interfere with each other in random and unpredictable ways.</p>
</div>
</div>
<div class="sect3">
<h4 id="forking_options"><a class="anchor" href="#forking_options"></a><a class="link" href="#forking_options">Forking options</a></h4>
<div class="paragraph">
<p>Gradle will run all tests in a single forked VM by default. This can be problematic if there are a lot of tests or some very memory-hungry ones. One option is to run the tests with a big heap, but you will still be limited by system memory and might encounter heavy garbage collection that slows the tests down.</p>
</div>
<div class="paragraph">
<p>Another option is to fork a new test VM after a certain number of tests have run. You can do this with the <code>forkEvery</code> setting:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test.forkEvery = <span class="integer">100</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Just be aware that forking a VM is a relatively expensive operation, so a small value here will severely handicap the performance of your tests.</p>
</div>
</div>
<div class="sect3">
<h4 id="report_generation"><a class="anchor" href="#report_generation"></a><a class="link" href="#report_generation">Report generation</a></h4>
<div class="paragraph">
<p>Gradle will automatically create test reports by default regardless of whether you want to look at them. That report generation takes time, slowing down the overall build. Reports are definitely useful, but do you need them every time you run the build? Perhaps you only care if the tests succeed or not. Also, if you&#8217;re using build scans, you don&#8217;t need to generate reports locally.</p>
</div>
<div class="paragraph">
<p>To disable the test reports, simply add this configuration:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    reports.html.enabled = <span class="predefined-constant">false</span>
    reports.junitXml.enabled = <span class="predefined-constant">false</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example applies to the default <code>Test</code> task added by the Java plugin, but you can also apply the configuration to any other <code>Test</code> tasks you have.</p>
</div>
<div class="paragraph">
<p>One thing to bear in mind is that you will probably want to conditionally disable or enable the reports, otherwise you will have to edit the build file just to see them. For example, you could enable the reports based on a project property:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    <span class="keyword">if</span> (!project.hasProperty(<span class="string"><span class="delimiter">&quot;</span><span class="content">createReports</span><span class="delimiter">&quot;</span></span>)) {
        reports...
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="compiling_java"><a class="anchor" href="#compiling_java"></a><a class="link" href="#compiling_java">Compiling Java</a></h3>
<div class="paragraph">
<p>The Java compiler is quite fast, especially compared to other languages on the JVM. And yet, if youâre compiling hundreds of non-trivial Java classes, even a short compilation time adds up to something significant. You can of course upgrade your hardware to make compilation go faster, but that can be an expensive solution. Gradle offers a couple of software-based solutions that might be more to your liking:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Compiler daemon</p>
</li>
<li>
<p>Compile avoidance and the java-library plugin</p>
</li>
<li>
<p>Incremental compilation</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="compiler_daemon"><a class="anchor" href="#compiler_daemon"></a><a class="link" href="#compiler_daemon">Compiler daemon</a></h3>
<div class="paragraph">
<p>The Gradle Java plugin allows you to run the compiler as a separate process by using the following configuration for any <code>JavaCompile</code> task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">&lt;taskname&gt;.options.fork = <span class="predefined-constant">true</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or, more commonly, to apply the configuration to <em>all</em> Java compilation tasks:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(JavaCompile) {
    options.fork = <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This process is reused for the duration of a build, so the forking overhead is minimal. The benefit of forking is that the memory-intensive compilation happens
in a different process, leading to much less garbage collection in the main Gradle daemon. Less garbage collection in the daemon means that Gradle&#8217;s infrastructure can run faster, especially if you are also using <code>--parallel</code>.</p>
</div>
<div class="paragraph">
<p>It&#8217;s unlikely to be useful for small projects, but you should definitely consider it if a single task is compiling close to a thousand or more source files together.</p>
</div>
</div>
<div class="sect2">
<h3 id="compile_avoidance"><a class="anchor" href="#compile_avoidance"></a><a class="link" href="#compile_avoidance">Compile avoidance</a></h3>
<div class="paragraph">
<p>A lot of the time, you are only changing internal implementation details of your code, e.g. editing a method body. Starting with Gradle 3.4, these so-called ABI-compatible
changes no longer trigger recompilation of downstream projects. This especially improves build times in large multi-project builds with deep dependency chains.</p>
</div>
<div class="paragraph">
<p>Note: If you use annotation processors, you need to explicitly declare them in order for compile avoidance to work. Read more about <a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java_compile_avoidance">compile avoidance</a> in the user guide.</p>
</div>
</div>
<div class="sect2">
<h3 id="the_java_library_plugin"><a class="anchor" href="#the_java_library_plugin"></a><a class="link" href="#the_java_library_plugin">The java-library plugin</a></h3>
<div class="paragraph">
<p>For a long time, you would declare your compile time dependencies using the <code>compile</code> configuration and all of them would be leaked into downstream projects.
Since Gradle 3.4, you can now clearly separate which dependencies are part of your <code>api</code> and which are only <code>implementation</code> details. Implementation dependencies
are not leaked into the compile classpath of downstream projects, which means that they will no longer be recompiled when such an implementation detail changes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
   api project(<span class="string"><span class="delimiter">&quot;</span><span class="content">myUtils</span><span class="delimiter">&quot;</span></span>)
   implementation <span class="string"><span class="delimiter">&quot;</span><span class="content">com.google.guava:guava:21.0</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can significantly reduce the "ripple" effect of a single change in large multi-project builds. The <code>implementation</code> Configuration is available in the <code>java</code>
plugin. <code>api</code> dependencies can only be defined by libraries, which should use the new <a href="https://docs.gradle.org/current/userguide/java_library_plugin.html"><code>java-library</code></a> plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="incremental_compilation"><a class="anchor" href="#incremental_compilation"></a><a class="link" href="#incremental_compilation">Incremental compilation</a></h3>
<div class="paragraph">
<p>Gradle can analyze dependencies down to the individual class level in order to recompile only the classes that were affected by a change. This option
will soon become the default setting, but you can already use it today to significantly speed up your incremental build times:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">tasks.withType(JavaCompile) {
    options.incremental = <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="low_level_profiling"><a class="anchor" href="#low_level_profiling"></a><a class="link" href="#low_level_profiling">Low level profiling</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sometimes your build can be slow even though your build scripts are doing everything right. This often comes down to
inefficiencies in plugins and custom tasks or constrained resources. The best way to find these kinds of bottlenecks is
using the <a href="https://github.com/gradle/gradle-profiler">Gradle Profiler</a>. The Gradle Profiler allows you to define scenarios like "Running 'assemble' after making an ABI-breaking change" and then automatically runs your build several times to warm it up and collect profiling data. It can
be used to produce build scans or together with other major profilers like JProfiler and YourKit. Using these method-level
profilers can often help you find inefficient algorithms in custom plugins. If you find that something in Gradle itself is
slowing down your build, don&#8217;t hesitate to send a profiler snapshot at <a href="mailto:performance@gradle.com">performance@gradle.com</a>.</p>
</div>
<div class="sect2">
<h3 id="profile_report"><a class="anchor" href="#profile_report"></a><a class="link" href="#profile_report">Profile report</a></h3>
<div class="paragraph">
<p>If you don&#8217;t have internet access or have some other reason not to use build scans, you can use the <code>--profile</code> command-line option:</p>
</div>
<div class="listingblock terminal">
<div class="content">
<pre>$ gradle --profile &lt;tasks&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This will result in the generation of an HTML report that you can find in the <em>build/reports/profile</em> directory of the <em>root</em> project. Each profile report has a timestamp in its name to avoid overwriting existing ones.</p>
</div>
<div class="paragraph">
<p>The report displays a breakdown of the time taken to run the build, though much less detailed than a build scan. Hereâs a screenshot of a real profile report showing the different categories that Gradle uses:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/gradle-profile-report.png" alt="Sample Gradle profile report">
</div>
<div class="title">Figure 17. An example profile report</div>
</div>
</div>
<div class="sect2">
<h3 id="understanding_the_performance_categories"><a class="anchor" href="#understanding_the_performance_categories"></a><a class="link" href="#understanding_the_performance_categories">Understanding the performance categories</a></h3>
<div class="paragraph">
<p>Both build scans and the local profile reports break build execution down into the same categories, which are explained in more details below.</p>
</div>
<div class="sect3">
<h4 id="startup"><a class="anchor" href="#startup"></a><a class="link" href="#startup">Startup</a></h4>
<div class="paragraph">
<p>This reflects Gradleâs initialization time, which consists mostly of</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JVM initialization and class loading</p>
</li>
<li>
<p>Downloading the Gradle distribution if youâre using the wrapper</p>
</li>
<li>
<p>Starting the daemon if a suitable one isnât already running</p>
</li>
<li>
<p>Time spent executing any Gradle initialization scripts</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Even if a build execution has a long startup time, a subsequent run will usually see a dramatic drop off in the startup time. The main reason for a build&#8217;s startup time to be persistently slow is a problem in your init scripts. Double check that the work youâre doing there is necessary and as performant as possible.</p>
</div>
</div>
<div class="sect3">
<h4 id="settings_and_em_buildsrc_em"><a class="anchor" href="#settings_and_em_buildsrc_em"></a><a class="link" href="#settings_and_em_buildsrc_em">Settings and <em>buildSrc</em></a></h4>
<div class="paragraph">
<p>Soon after Gradle has got itself up and running, it initializes your project. This commonly just means processing your <em>settings.gradle</em> file, but if you have custom build logic in a <em>buildSrc</em> directory, that gets built as well.</p>
</div>
<div class="paragraph">
<p>The sample profile report shows a time over 1.6 second for this category, the vast majority of which was spent building the <em>buildSrc</em> project. This part fortunately wonât take so long once <em>buildSrc</em> is built once, as Gradle will consider it up to date. The up-to-date checks still take a little time, but nowhere near as much. If you do have problems with a persistently time consuming <em>buildSrc</em> phase, you should consider breaking it out into a separate project whose JAR artifact is added to the build&#8217;s classpath.</p>
</div>
<div class="paragraph">
<p>The <em>settings.gradle</em> file rarely has computationally or IO expensive code in it. If you find that Gradle is taking a significant amount of time to process it, you should use more traditional profiling methods, such as <a href="https://github.com/gradle/gradle-profiler">the Gradle Profiler</a> to determine why.</p>
</div>
</div>
<div class="sect3">
<h4 id="loading_projects"><a class="anchor" href="#loading_projects"></a><a class="link" href="#loading_projects">Loading projects</a></h4>
<div class="paragraph">
<p>It normally doesnât take a significant amount of time to load projects, nor do you have any control over it. The time spent here is basically a function of the number of projects you have in your build.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="suggestions_for_android_builds"><a class="anchor" href="#suggestions_for_android_builds"></a><a class="link" href="#suggestions_for_android_builds">Suggestions for Android builds</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Everything discussed thus far applies to Android builds too, since they&#8217;re based on Gradle. Yet Android also introduces its own performance factors. The Android Studio team has put together their own excellent <a href="https://developer.android.com/studio/build/optimize-your-build.html">performance guide</a>. You can also <a href="https://www.youtube.com/watch?v=7ll-rkLCtyk">watch the accompanying talk</a> from Google IO 2017.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary"><a class="anchor" href="#summary"></a><a class="link" href="#summary">Summary</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Performance is not an afterthought in your build - it is a key feature affecting your team&#8217;s productivity and happiness. The Gradle team is focused on making Gradle builds as fast as possible out of the box because they know that your time is valuable. Even so, Gradle supports a huge variety of builds which means that sometimes the default settings won&#8217;t always be ideal for <em>your</em> project. To help you optimize your build, this guide introduced you to settings and options that allow you to customize Gradle&#8217;s behavior to best suite your particular build.</p>
</div>
<div class="paragraph">
<p>Beyond those settings, remember that the two big contributors to build times are configuration and task execution, although the base cost of the former drops with almost every major Gradle release. And as far as the configuration phase goes, you should now have a good idea of the pitfalls you need to avoid. With task execution, you have more control since you can avoid running tasks or running them too often. You can also code your own tasks to be as efficient as possible.</p>
</div>
<div class="paragraph">
<p>You can also leverage build scans to gain deep insights into performance hotspots during configuration and execution in your build. Furthermore, build scans allow you to easily share specific aspects of your build and collaborate about them with your colleagues.</p>
</div>
<div class="paragraph">
<p>Hopefully the ideas in this guide help you cut your build times and improve your overall build experience!</p>
</div>
</div>
</div>
<div class="sect1 contribute">
<h2 id="help_improve_this_guide"><a class="anchor" href="#help_improve_this_guide"></a><a class="link" href="#help_improve_this_guide">Help improve this guide</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Have feedback or a question? Found a typo? Like all Gradle guides, help is just a GitHub issue away. Please add an issue or pull request to <a href="https://github.com/gradle-guides/performance/">gradle-guides/performance</a> and we&#8217;ll get back to you.</p>
</div>
</div>
</div>
</div>
<footer class="site-layout__footer site-footer" itemscope="itemscope" itemtype="https://schema.org/WPFooter">
    <nav class="site-footer__navigation" itemtype="https://schema.org/SiteNavigationElement">
        <section class="site-footer__links">
            <div class="site-footer__link-group">
                <header><strong>Docs</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://docs.gradle.org/current/userguide/userguide.html" itemprop="url">User Manual</a></li>
                    <li itemprop="name"><a href="https://docs.gradle.org/current/dsl/" itemprop="url">DSL Reference</a></li>
                    <li itemprop="name"><a href="https://guides.gradle.org" itemprop="url">Guides</a></li>
                    <li itemprop="name"><a href="https://docs.gradle.org/current/javadoc/" itemprop="url">Javadoc</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>News</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://blog.gradle.org/" itemprop="url">Blog</a></li>
                    <li itemprop="name"><a href="https://newsletter.gradle.com/" itemprop="url">Newsletter</a></li>
                    <li itemprop="name"><a href="https://twitter.com/gradle" itemprop="url">Twitter</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Products</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://gradle.com/build-scans" itemprop="url">Build Scans</a></li>
                    <li itemprop="name"><a href="https://gradle.com/build-cache" itemprop="url">Build Cache</a></li>
                    <li itemprop="name"><a href="https://gradle.com/enterprise/resources" itemprop="url">Enterprise Docs</a></li>
                </ul>
            </div>
            <div class="site-footer__link-group">
                <header><strong>Get Help</strong></header>
                <ul class="site-footer__links-list">
                    <li itemprop="name"><a href="https://discuss.gradle.org/c/help-discuss" itemprop="url">Forums</a></li>
                    <li itemprop="name"><a href="https://github.com/gradle/" itemprop="url">GitHub</a></li>
                    <li itemprop="name"><a href="https://gradle.org/training/" itemprop="url">Training</a></li>
                    <li itemprop="name"><a href="https://gradle.org/services/" itemprop="url">Services</a></li>
                </ul>
            </div>
        </section>
        <section class="site-footer__subscribe-newsletter">
            <p>Subscribe for important Gradle updates and news</p>
            <form id="newsletter-form" class="newsletter-form" action="https://go.pardot.com/l/68052/2017-12-01/b8dh7j" method="post">
                <input id="email" class="email" name="email" type="email" placeholder="name@email.com" pattern="[^@s]+@[^@s]+.[^@s]+" maxlength="255" required=""/>
                <button id="submit" class="submit" type="submit">Subscribe</button>
            </form>
        </section>
    </nav>
    <div class="site-footer-secondary">
        <div class="site-footer-secondary__contents">
            <div class="site-footer__copy">Â© <a href="https://gradle.com">Gradle Inc.</a> <time>2018</time> All rights reserved.</div>
            <div class="site-footer__logo"><a href="https://docs.gradle.org/current/"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40" class="logo-icon"><g style="fill:none;opacity:0.7"><g fill="#11272E"><path d="M37.7 7.1C36.4 4.8 34 4 32.4 4 30.4 4 28.7 5.1 29 5.9 29.1 6 29.5 6.8 29.7 7.2 30 7.7 30.6 7.3 30.9 7.2 31.5 6.9 32.2 6.7 32.9 6.8 33.6 6.9 34.6 7.4 35.3 8.6 36.8 11.6 32.1 17.8 26.2 13.5 20.3 9.3 14.5 10.7 11.9 11.5 9.3 12.4 8.1 13.3 9.2 15.3 10.6 18 10.1 17.1 11.5 19.4 13.6 22.9 18.3 17.7 18.3 17.7 14.8 23 11.8 21.7 10.6 19.9 9.6 18.2 8.8 16.3 8.8 16.3 -0.1 19.5 2.3 33.6 2.3 33.6L6.7 33.6C7.9 28.4 11.9 28.6 12.6 33.6L15.9 33.6C18.9 23.5 26.4 33.6 26.4 33.6L30.8 33.6C29.6 26.7 33.3 24.5 35.6 20.5 37.9 16.4 40.1 11.5 37.7 7.1L37.7 7.1ZM26.3 20.5C24 19.7 24.9 17.3 24.9 17.3 24.9 17.3 26.9 18 29.6 18.9 29.5 19.6 28.1 21 26.3 20.5L26.3 20.5Z"/><path d="M28.4 18.7C28.5 19.3 28 19.9 27.3 20 26.6 20.1 26 19.6 26 18.9 25.9 18.3 26.4 17.7 27.1 17.6 27.7 17.6 28.3 18 28.4 18.7"/><path d="M37.7 7.1C36.4 4.8 34 4 32.4 4 30.4 4 28.7 5.1 29 5.9 29.1 6 29.5 6.8 29.7 7.2 30 7.7 30.6 7.3 30.9 7.2 31.5 6.9 32.2 6.7 32.9 6.8 33.6 6.9 34.6 7.4 35.3 8.6 36.8 11.6 32.1 17.8 26.2 13.5 20.3 9.3 14.5 10.7 11.9 11.5 9.3 12.4 8.1 13.3 9.2 15.3 10.6 18 10.1 17.1 11.5 19.4 13.6 22.9 18.3 17.7 18.3 17.7 14.8 23 11.8 21.7 10.6 19.9 9.6 18.2 8.8 16.3 8.8 16.3 -0.1 19.5 2.3 33.6 2.3 33.6L6.7 33.6C7.9 28.4 11.9 28.6 12.6 33.6L15.9 33.6C18.9 23.5 26.4 33.6 26.4 33.6L30.8 33.6C29.6 26.7 33.3 24.5 35.6 20.5 37.9 16.4 40.1 11.5 37.7 7.1L37.7 7.1ZM26.3 20.5C24 19.7 24.9 17.3 24.9 17.3 24.9 17.3 26.9 18 29.6 18.9 29.5 19.6 28.1 21 26.3 20.5L26.3 20.5Z"/><path d="M28.4 18.7C28.5 19.3 28 19.9 27.3 20 26.6 20.1 26 19.6 26 18.9 25.9 18.3 26.4 17.7 27.1 17.6 27.7 17.6 28.3 18 28.4 18.7"/></g></g></svg></a></div>
            <div class="site-footer-secondary__links">
                <a href="https://gradle.com/careers" >Careers</a> |
                <a href="https://gradle.org/privacy">Privacy</a> |
                <a href="https://gradle.org/terms">Terms of Service</a> |
                <a href="https://gradle.org/contact/">Contact</a>
            </div>
        </div>
    </div>
</footer>
</body>
</html>